# chuanzhijiankang
#### 跟着某马的b站视频写的
###### 感谢辉少的无私帮助！提供他参加某马培训后的源码，这个项目的前端网页什么都是自带的，视频直接讲解后端，如果没有前端的源码是写不出来的

* 上传于2020.12.18

这是一个提供给用户网页端与微信端预约体检的项目，也是我做完的第一个java练手项目。回过头来发现是基本的增删改查，但真真实实教会了我框架与工具如何协同与工作。以前入学之前学了java和sql正好全部用上了。

不过不可否认的是项目停留在工具的应用，还需要深入了解工具的实现才能说是真正理解了工具。但第一次成功还是很高兴

* **框架：Spring Framework, Spring MVC, Spring Security**

* **数据库：Mysql+redis**

* **查询工具：Mybatis**

* **前端：javascript，ElementUI,VUE**

* **分布实现：Zookeeper，Dubbo**

其实这个项目还有什么知识库管理等其他条目，但由于某马也只教到预约查询管理等，因此并没有写其他的条目。

该项目基于SOA架构，用户发送的请求都会被dubbo传到provider_servier 上，由provider统一调度

1. 预约管理：实现了“检查项管理”条目中对数据库整一个所有已有检查项的分页展示，分页用的是mybatis自带的pagehelper，实现“查询”和“新建”按钮对数据库的操作。随后实现具体某一条检查项的“编辑”和“删除”，

* 这里有一个恶心的坑，在删除指令时，使用axios.get(".../delete.do?id=" +row.id) 这样回传id是读不出来的，但是在视频里却可以，这个卡了我很久，原因我猜是版本更替的缘故，这个失效了。

* 具体更改方法是使用反引号然后用${}修改get(`.../delete/${row.id}.do`) 然后controller里面的的@Requsetmapping也相应加（/{id}）,最后在方法的参数前面加@Pathvariable("id").这样才能回传，数据库才能执行删除操作.编辑操作同样

2. 实现检查组数据库分页展示，查询与新建，检查组包含了多个检查项，这俩数据库是一个多对多关系，通过一个t_checkgroup_checkitem里面存储各自的Id进行关联，所以这里学习了一个mybaits获取插入单表的id的方法,可以用来更新中间关系表：
 
```
   <selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
   select LAST_INSERT_ID()
   </selectKey> 
```
3. 实现新增套餐setmeal，是检查组的集合，其实就是套娃，由于有图片，所以这里需要用到七牛云的云服务，定期清理用户上传了图片但没有按“确定”按钮来确认套餐的垃圾图片。具体实现方法是用redis，存储一个全部图片集合，另一个确认套餐的图片名称集合，求插值获得到垃圾图片的集合，定期进行删除。教了一下redis的基本操作。


4. 设置每日套餐具体预约人数，超过一定人数不可预约，可以自己在页面“设置”按钮手动设置，也可以下载模板上传设置。

5. 之后就是微信端开发内容，其实是用订阅号进行了网站订阅，套路和上面是一样的。


